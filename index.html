<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Bear Learn ‚Äî Offline Maths Practice</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#60a5fa;--muted:#94a3b8;--glass: rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
    body{background:linear-gradient(180deg,#071226 0%, #081022 50%);color:#e6eef8;padding:20px}
    .app{max-width:1100px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    h1{font-size:20px;margin:0}
    .controls{display:flex;gap:8px;margin-left:auto}
    .btn{background:var(--accent);border:none;padding:8px 12px;border-radius:8px;color:#062226;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}
    .grid{display:grid;grid-template-columns:360px 1fr;gap:18px}
    .panel{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .topics{max-height:68vh;overflow:auto;padding-right:6px}
    .topic{padding:10px;border-radius:8px;margin-bottom:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);cursor:pointer}
    .topic.active{outline:2px solid rgba(96,165,250,0.18);box-shadow:0 4px 14px rgba(96,165,250,0.06)}
    .meta{font-size:13px;color:var(--muted)}
    .question-area{min-height:60vh;display:flex;flex-direction:column}
    .question-box{background:var(--glass);padding:12px;border-radius:8px;margin-bottom:10px}
    .qtext{font-size:18px}
    .answers{display:flex;flex-direction:column;gap:8px;margin-top:10px}
    .answer{display:flex;gap:10px;align-items:center}
    input[type="text"],input[type="password"]{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:auto}
    .small{font-size:13px;color:var(--muted)}
    .timer{font-weight:700}
    .score{background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:10px}
    .help{color:var(--muted);font-size:13px}
    .search{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit;margin-bottom:8px}
    .topic-list-legend{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .badge{background:rgba(255,255,255,0.03);padding:4px 8px;border-radius:999px;font-size:12px}
    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}
    #loginModal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center}
    #loginModal .panel{max-width:400px;width:90%;}
  </style>
</head>
<body>
  <div id="loginModal">
    <div class="panel">
      <h2>Welcome to Bear Learn</h2>
      <p style="color:var(--muted);font-size:14px">Create an account or log in. Your progress is saved locally ‚Äî no internet required.</p>
      <input type="text" id="username" placeholder="Username" style="width:100%;margin-bottom:8px">
      <input type="password" id="password" placeholder="Password" style="width:100%;margin-bottom:8px">
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn ghost" onclick="closeLogin()">Cancel</button>
        <button class="btn" onclick="loginOrCreate()">Log in / Create</button>
      </div>
    </div>
  </div>

  <div class="app" id="app" style="display:none">
    <header>
      <h1>üêª Bear Learn</h1>
      <div class="controls">
        <button class="btn" id="startBtn">Start Test</button>
        <button class="btn ghost" id="shuffleBtn">Shuffle Questions</button>
        <button class="btn ghost" onclick="logout()">Log Out</button>
      </div>
    </header>

    <div class="grid">
      <aside class="panel">
        <div class="topic-list-legend">
          <strong>Topics</strong>
          <div class="badge" id="selectionInfo">0 selected</div>
        </div>
        <input id="topicSearch" class="search" placeholder="Search topics by name or number..." />
        <div class="topics" id="topics"></div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button class="btn ghost" id="selectAll">Select All</button>
          <button class="btn ghost" id="clearSelection">Clear</button>
        </div>
      </aside>

      <main class="panel question-area">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <div>
            <div class="small">Current topic</div>
            <div id="currentTopicName" style="font-weight:700">Pick a topic on the left</div>
          </div>
          <div style="display:flex;align-items:center;gap:12px">
            <div class="small">Timer <span id="timer" class="timer">00:00</span></div>
            <div class="score small">Score <span id="score">0/0</span></div>
          </div>
        </div>

        <div id="questionsContainer">Select a topic to see questions.</div>

        <div class="footer">
          <div class="help">Tip: your progress is stored in your browser. Clear cache to reset.</div>
          <div style="display:flex;gap:8px">
            <button class="btn ghost" id="prevTopic">Prev</button>
            <button class="btn" id="submitAnswers">Submit</button>
            <button class="btn ghost" id="nextTopic">Next</button>
          </div>
        </div>
      </main>
    </div>

    <footer>Bear Learn works fully offline ‚Äî no data is sent to any server.</footer>
  </div>

  <script>
    const NUM_TOPICS=100;const Q_PER_TOPIC=10;const CATEGORIES=['Addition','Subtraction','Multiplication','Division','Fractions','Decimals','Percentages','Algebra','Linear Equations','Squares & Powers','Roots','Indices','Ratio','Proportion','Geometry','Angles','Area & Perimeter','Volume','Sequences','Probability','Statistics','Coordinate Geometry','Inequalities','Exponents','Surds'];
    function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
    function simplifyFraction(n,d){function gcd(a,b){return b?gcd(b,a%b):a}const g=gcd(n,d);return `${n/g}/${d/g}`}
    function generateQuestion(topicIndex){const difficulty=1+Math.floor(topicIndex/10);const cat=CATEGORIES[topicIndex%CATEGORIES.length];switch(cat){case'Addition':{const a=randInt(1,10*difficulty);const b=randInt(1,10*difficulty);return{q:`${a} + ${b} = ?`,a:(a+b).toString()}}case'Subtraction':{const a=randInt(5,15*difficulty);const b=randInt(1,10*difficulty);return{q:`${a} - ${b} = ?`,a:(a-b).toString()}}case'Multiplication':{const a=randInt(2,5+difficulty);const b=randInt(2,5+difficulty);return{q:`${a} √ó ${b} = ?`,a:(a*b).toString()}}default:{const a=randInt(1,20);const b=randInt(1,20);return{q:`${a} + ${b} = ?`,a:(a+b).toString()}}}}
    const topics=Array.from({length:NUM_TOPICS},(_,i)=>({id:i,name:`Topic ${i+1}: ${CATEGORIES[i%CATEGORIES.length]}`,questions:Array.from({length:Q_PER_TOPIC},()=>generateQuestion(i))}));
    let selectedTopicIndex=null;let selectedTopicIds=new Set();let startTime=null;let timerInterval=null;
    function renderTopics(filter=''){const topicsEl=document.getElementById('topics');topicsEl.innerHTML='';topics.forEach(t=>{if(filter&&!t.name.toLowerCase().includes(filter.toLowerCase()))return;const div=document.createElement('div');div.className='topic'+(selectedTopicIds.has(t.id)?' active':'');div.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${t.name}</strong><div class='meta'>${t.questions.length} questions</div></div><div><input type='checkbox' data-id='${t.id}' ${selectedTopicIds.has(t.id)?'checked':''}></div></div>`;div.querySelector('input').addEventListener('change',e=>{const id=Number(e.target.dataset.id);if(e.target.checked)selectedTopicIds.add(id);else selectedTopicIds.delete(id);document.getElementById('selectionInfo').innerText=`${selectedTopicIds.size} selected`;div.classList.toggle('active',selectedTopicIds.has(id))});div.addEventListener('click',e=>{if(e.target.tagName==='INPUT')return;selectTopic(t.id)});topicsEl.appendChild(div)})}
    function selectTopic(id){selectedTopicIndex=id;const t=topics[id];document.getElementById('currentTopicName').innerText=t.name;renderQuestions(t);Array.from(document.querySelectorAll('.topic')).forEach((el,idx)=>{el.classList.toggle('active',topics[idx]&&topics[idx].id===id)})}
    function renderQuestions(topic){const container=document.getElementById('questionsContainer');container.innerHTML='';topic.questions.forEach((q,i)=>{const box=document.createElement('div');box.className='question-box';box.innerHTML=`<div class='qtext'><strong>Q${i+1}.</strong> ${q.q}</div><div class='answers'><div class='answer'><label>Answer:</label><input type='text' data-ans-index='${i}'></div></div><div class='meta' style='margin-top:8px'>Correct answer: <span class='correct' data-correct='${q.a}'>Hidden</span></div>`;container.appendChild(box)});document.getElementById('score').innerText=`0/${topic.questions.length}`}
    function startTimer(){if(timerInterval)clearInterval(timerInterval);startTime=Date.now();timerInterval=setInterval(()=>{const diff=Math.floor((Date.now()-startTime)/1000);const mm=String(Math.floor(diff/60)).padStart(2,'0');const ss=String(diff%60).padStart(2,'0');document.getElementById('timer').innerText=`${mm}:${ss}`},250)}
    document.getElementById('submitAnswers').addEventListener('click',()=>{if(selectedTopicIndex===null){alert('Pick a topic first');return}const topic=topics[selectedTopicIndex];const inputs=Array.from(document.querySelectorAll('#questionsContainer input[type=text]'));let correct=0;inputs.forEach((inp,i)=>{const user=inp.value.trim();const corr=topic.questions[i].a.toString().trim();const corrEl=inp.closest('.question-box').querySelector('.correct');if(user===corr){correct++;corrEl.innerText='‚úì '+corr}else{corrEl.innerText='‚úó '+corr}});document.getElementById('score').innerText=`${correct}/${topic.questions.length}`;saveProgress()});
    document.getElementById('nextTopic').addEventListener('click',()=>{if(selectedTopicIndex===null)return selectTopic(0);selectTopic((selectedTopicIndex+1)%topics.length)});
    document.getElementById('prevTopic').addEventListener('click',()=>{if(selectedTopicIndex===null)return selectTopic(0);selectTopic((selectedTopicIndex-1+topics.length)%topics.length)});
    document.getElementById('topicSearch').addEventListener('input',e=>renderTopics(e.target.value));
    document.getElementById('startBtn').addEventListener('click',()=>{if(selectedTopicIndex!==null){selectTopic(selectedTopicIndex)}else selectTopic(0);startTimer()});
    document.getElementById('shuffleBtn').addEventListener('click',()=>{topics.forEach((t,i)=>t.questions=Array.from({length:Q_PER_TOPIC},()=>generateQuestion(i)));if(selectedTopicIndex!==null)renderQuestions(topics[selectedTopicIndex]);alert('Questions regenerated.')});
    function saveProgress(){const progress={topic:selectedTopicIndex,answers:Array.from(document.querySelectorAll('#questionsContainer input[type=text]')).map(i=>i.value)};localStorage.setItem('bearLearnProgress',JSON.stringify(progress))}
    function loadProgress(){const saved=localStorage.getItem('bearLearnProgress');if(!saved)return;const data=JSON.parse(saved);if(data.topic!==null)selectTopic(data.topic);setTimeout(()=>{const inputs=document.querySelectorAll('#questionsContainer input[type=text]');data.answers.forEach((v,i)=>{if(inputs[i])inputs[i].value=v})},100)}
    function loginOrCreate(){const user=document.getElementById('username').value.trim();const pass=document.getElementById('password').value; if(!user||!pass){alert('Enter username & password');return}const key='bearLearnUser:'+user;const existing=localStorage.getItem(key);if(existing){if(existing===pass){closeLogin();document.getElementById('app').style.display='block';loadProgress()}else alert('Wrong password')}else{localStorage.setItem(key,pass);closeLogin();document.getElementById('app').style.display='block'}}
    function closeLogin(){document.getElementById('loginModal').style.display='none'}
    function logout(){document.getElementById('app').style.display='none';document.getElementById('loginModal').style.display='flex'}
    renderTopics();document.getElementById('loginModal').style.display='flex';
  </script>
</body>
</html>
